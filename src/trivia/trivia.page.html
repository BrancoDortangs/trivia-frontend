<form #form="ngForm" (ngSubmit)="onSubmit()">
  @for (question of questions(); track question.id) {
    <div class="my-2">
      @if (question.type === 'boolean') {
        <div class="w-full mb-4">
          <label class="text-lg font-semibold" for="question_{{ question.id }}">
            {{ question.question }}
          </label>
        </div>
        <p-toggle-button
          class="w-2/12"
          [required]="true"
          [inputId]="'question_' + question.id"
          [name]="'question_' + question.id"
          [onLabel]="'Yes'"
          [offLabel]="'No'"
          [ngModel]="answerPerQuestionId().get(question.id) ?? false"
          (onChange)="changeAnswer(question.id, $event.checked ?? false)"
        />
        @if (correctAnswerPerQuestionId().size > 0) {
          @if (correctAnswerPerQuestionId().get(question.id)?.isCorrect) {
            <i class="ml-2 pi pi-check text-green-500"></i>
          } @else {
            <i class="ml-2 pi pi-times text-red-500"></i>
          }
        }
      } @else if (question.type === 'multiple') {
        <div class="w-full mb-4">
          <p class="text-lg font-semibold">{{ question.question }}</p>
        </div>

        <div class="w-full flex flex-col gap-3">
          @for (answer of question.answers; track answer) {
            <label [for]="'question_' + question.id + '_answer_' + $index">
              <p-radio-button
                class="mr-2"
                [required]="true"
                [inputId]="'question_' + question.id + '_answer_' + $index"
                [name]="'question_' + question.id"
                [value]="answer"
                [ngModel]="answerPerQuestionId().get(question.id) ?? ''"
                (onClick)="changeAnswer(question.id, $event.value)"
              />
              <span
                [ngClass]="
                  correctAnswerPerQuestionId().size > 0
                    ? correctAnswerPerQuestionId().get(question.id)?.correctAnswer === answer
                      ? 'text-green-500'
                      : !correctAnswerPerQuestionId().get(question.id)?.isCorrect &&
                          correctAnswerPerQuestionId().get(question.id)?.answer === answer
                        ? 'text-red-500'
                        : ''
                    : ''
                "
              >
                {{ answer }}
              </span>
            </label>
          }
        </div>
      }
    </div>

    <p-divider />
  }

  <div class="flex justify-between mt-2">
    <p-button
      [label]="'Get new questions'"
      [severity]="'secondary'"
      (onClick)="getNewQuestions()"
    />

    <p-button [type]="'submit'" [disabled]="form.invalid" [label]="'Submit'" />
  </div>
</form>
